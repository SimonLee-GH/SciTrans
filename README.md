# SciTrans
**更新日期 2023-6-30**  
目前还没开始写代码，做了一些调查工作  
在第一次更新提到的第一个问题（**pdf单个页面的图片区域和文字区域区分**），把图片和文本分开，好像有一个说法叫做**数字图书版面分割**  
Mathpix 的pdf转latex如果人工把页眉页脚裁剪掉竟然可以直接把图片识别出来单独保存下来，付费的算法做的还是牛逼。但是如果启用他的自动序号，整个latex的章节序号系统就很乱，但是如果不启用，他就会完全识别不到章节序号，不太清楚他为什么会这样。  
接下来的思路可能会变成这样：
## 1. 深度学习算法
把几千页的pdf输入给mathpix，让他产生对应的latex文件和图片，因为他图片的位置在latex中会引用，所以通过**某种方法**(暂时未知，但直觉感觉不难)应该可以或许到这个图片在pdf页面中的位置。  
这样就相当于有了几千组数字图书版面分割的数据集，可以训练自己的模型（听说Unet可以做到，需要后续测试研究）。*或许甚至可以得到pdf转latex的数据集*     
但总而言之做训练的话数据集来源应该不愁了  
*我问过淘宝数据标注的，一个目标图片0.4-0.6元，多少有点抢钱了，mathpix会员300多一年可以转6000页的pdf和60000张图片，后续pdf也只要1分钱一页，属于是划算极了*
## 2. 章节问题
不直接使用mathpix转换来的Latex最大的原因就在这，现在的想法是上面的图片和其位置获得下来之后，还是对单个pdf页面进行裁剪，一段文本一段文本的裁剪，然后通过图片转latex的方式，这样序号就会被当作文本保留下来，后续或许可以通过NLP的方式来把序号识别出来再转换为latex的章节序号形式  

## 瞎逼逼
*之前因为神经网络算法在控制领域疯狂水论文对神经网络算法有很大的偏见，现在看来有些东西不靠神经网络确实也没什么更好的办法，技术只是技术，希望自己以后能更加平和的看待技术的不同。*  
*但我仍然反对把神经网络算法称之为**人工智能***  
以上  
  
**创建日期 2023-06-29**  
目前来说有一个简单的想法，分为以下几个步骤  
*图片指文稿截图，插图指的是文稿中的插图，以作区分*  
## 1. pdf单个页面的图片区域和文字区域区分  
类似于pdf软件的编辑pdf功能ocr会出现的结果，插图单独从文字中分离出来  
**可能出现的问题** *(其实是一定出现的问题*：   
### 问题1  
最为简单的情况下如下图  
![page_1](SamplePages/page_1/page_1.png)  
文档图片中插图只是类似于照片，不包含可能被pdf软件识别出的文字  
**问题是下面这个**    
![page_2](SamplePages/page_2/page_2.png)  
这种坐标系中的与文档字体接近的文字，会被识别出来  
需要的解决方案是把插图整体与文字分割开来  
**好消息是我们后面要用的mathpix好像会直接无视掉插图（乐**  
但还是要区分,因为要把图片单独提取出来  

### 问题2  
页眉，页脚，小注  
感觉没啥太好办法，但是基本上一本书中的这个格式是相同的，直接在处理前人工裁剪吧，目前是这么蠢的办法了  

### 问题3  
如何把切割下来的插图和插图标注对应上，因为在latex中实际上可以给图片直接生成label  
```latex
\begin{figure}
  \centering
  \includegraphics[width=0.5\textwidth]{your_image_file.png}
  \caption{这是插图的标题}
  \label{fig:example}
\end{figure}
```
如果我们在这一步把插图和插图的标题对应上，那么我们在翻译完成后可以直接把图片再插入回标题的位置，关键还是要获取插图的位置和标题的位置，以及考虑是否要把标题从翻译的文本中裁剪出去  

说的很复杂但其实想要的效果很简单，可以参见SamplePage文件夹下两张示例图片分别的CroppedResults(*我手裁的*)  


### 问题4  
小节标题，先不管了，当正文处理  

## 2.文字区域图片转latex  
我氪金了，mathpix太好用了，还有现成的api。网上自己训练的模型基本没有什么能打得过的，还有一个不氪金的办法就是邮箱轰炸latexlive，识别准确里也很高，每天限免40个   
有一个repo是im2latex还挺火的，效果不错，但不能让人满意[im2latex](https://github.com/kingyiusuen/image-to-latex), 但repo owner自己后面也说他觉得mathpix真香    
但是mathpix的pdf转换有点难用，问题主要出在小节标题上，完全处于一种错乱状态
mathpix的pdf直接生成的还有个大问题是图片比例完全不对了，**这个要在这个项目中想办法解决**  

## 3.latex翻译  
前一段在用ChatGPT的时候发现他竟然能输出公式，并且直接就是latex格式的，这也是我这个项目的思路启发点吧，现在的想法就是把文稿图片识别生成的latex文本直接丢给chatgpt，让他去翻译，并且保留latex格式，通过前面几次调试使其稳定输出正确的代码  

想法是可以把截图下来的文稿片段和图片按照原文的顺序存档并且逐个翻译，再按照这个顺序生成latex，图片的话就是翻译图片标题也存储下来  


## 4.latex本地生成pdf  
没什么好说的，latex代码要是正确，依次输入到latex文档中然后编译pdf就可以了  

 
